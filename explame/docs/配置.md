---
title: é…ç½®
group: å¿«é€Ÿå¼€å§‹
lang: zh-CN
outline: 'deep'
---

# é…ç½®
é™¤äº†æ–‡æ¡£æ‰«æä¹‹å¤–ï¼Œunmonoè¿˜æ”¯æŒåº“æ„å»ºï¼Œåº“æ„å»ºéœ€è¦ä¸€äº›é¢å¤–çš„é…ç½®ä¿¡æ¯ï¼Œä¸‹é¢å†…å®¹éƒ½æ˜¯ä¸º `unmono build` æä¾›é¢å¤–çš„æ„å»ºä¿¡æ¯

## é…ç½®ä¿¡æ¯
unmono æ²¡æœ‰å•ç‹¬çš„é…ç½®æ–‡ä»¶ï¼Œæ‰€æœ‰é…ç½®ä¿¡æ¯éƒ½åœ¨é¡¹ç›®çš„package.jsonä¸­è¯»å–

::: warning æç¤º
æ‹·è´ä¸‹é¢é…ç½®æ—¶ï¼Œè¯·å°†æ³¨é‡Šåˆ æ‰ï¼Œå¦‚æœdtsä¸ºtrueï¼Œåˆ™éœ€è¦é…ç½®tsconfig.json

dtsæ˜¯å‰¥ç¦»ä»£ç é€»è¾‘åçš„ç±»å‹ï¼Œä»–äººåœ¨å®‰è£…ä½ çš„åº“æ—¶ï¼Œå¦‚æœä½ çš„åº“æ—¶tsç¼–å†™çš„ï¼Œå¼€å¯dtsåå¹¶é…ç½®tsconfig.jsonåï¼Œäº§ç‰©ä¸­å°†åŒ…å«dtsï¼Œè¿™æ ·ä»–äººåœ¨å¼•ç”¨ä»£ç æ—¶ï¼Œå°†ä¼šè·å¾—ç±»å‹æç¤º
:::

```json
{
  "name": "my-project",
  "version": "0.0.1",
  "unmono": { // [!code ++]
    // æ„å»ºå…¥å£(é»˜è®¤ä¸º["src/index.ts"]ï¼Œå¿…é¡»æ˜¯æ•°ç»„ï¼Œæ”¯æŒå¤šä¸ª) // [!code ++]
    "entry": ["src/index.ts"], // [!code ++]
    // æ„å»ºä½ç½®(é»˜è®¤ä¸ºdist-libç›®å½•) // [!code ++]
    "output": "dist-lib", // [!code ++]
    // æ–‡æ¡£publicPathè·¯å¾„(é»˜è®¤ä¸º/) // [!code ++]
    "publicPath": "/", // [!code ++]
     // æ‰«æè·¯å¾„(é»˜è®¤ä¸º.) // [!code ++]
    "documentPath": "./", // [!code ++]
     // æ–‡æ¡£æ‰«æ„å»ºè·¯å¾„ (é»˜è®¤ä¸º [documentPath]/.unmono/dist) // [!code ++]
    "documentBuildPath": "./doc-dist", // [!code ++]
    // æ–‡æ¡£é¡µæè¿°(é»˜è®¤ä¸ºç©º,ç”¨äºseo) // [!code ++]
    "description": "unmono description", // [!code ++]
    // æ–‡æ¡£é¡µæ ‡é¢˜(é»˜è®¤ä¸ºUnmono) // [!code ++]
    "title": "Unmono", // [!code ++]
    // æ˜¯å¦æ„å»ºd.ts (é»˜è®¤ä¸ºfalse,å¦‚æœè®¾ä¸ºtrue,åˆ™éœ€è¦é…ç½®tsconfig) // [!code ++]
    "dts": true, // [!code ++]
    // æŒ‡å®šd.tsçš„tsconfigè·¯å¾„ (é»˜è®¤ä¸ºpackagesåŒçº§çš„tsconfig.json) // [!code ++]
    "tsconfig": "tsconfig.json" // [!code ++]
  }, // [!code ++]
  "scripts": {
    "dev": "...",
    "build": "...",
  },
}
```
## tsconfig.json

å¦‚æœdtsä¸ºtrueï¼Œåˆ™éœ€è¦é…ç½®tsconfig.jsonï¼Œéœ€è¦é¢å¤–é…ç½®çš„ä¿¡æ¯å¦‚ä¸‹

```json
{
  "compilerOptions": {
    // å¯¼å‡ºæ¨¡å—ç±»å‹(æ³¨æ„è¿™é‡Œä»…æ”¯æŒesmodule) 
    "target": "esnext", // [!code ++]
    "resolveJsonModule": true,
    "verbatimModuleSyntax": true,
    "jsx": "preserve",
    "lib": [
      "esnext",
      "dom",
      "dom.iterable"
    ]
  },
  // å“ªäº›ç±»å‹ä¼šè¢«å¯¼å‡ºåˆ°d.ts 
  "include": [ // [!code ++]
    "src/**/*", // [!code ++]
    "rollup.config.ts" // [!code ++]
  ], // [!code ++]
  // å“ªäº›ç±»å‹ä¸ä¼šè¢«å¯¼å‡ºåˆ°d.ts 
  "exclude": [ // [!code ++]
    "**/node_modules/**", // [!code ++]
    "**/dist/**", // [!code ++]
  ]
}
```

ç°åœ¨æ‰§è¡Œ`npx unmono build`

ğŸ‰ å°†ä¼šåœ¨`ä¸Šé¢é…ç½®çš„outputç›®å½•`ä¸­çœ‹åˆ°æ„å»ºæ—¶çš„ä»£ç 

## å†…å¤–éƒ¨ä¾èµ–

`unmono build`éµå¾ªnpmåŒ…ç®¡ç†çš„ä¾èµ–è§„åˆ™

### åŒ…ç®¡ç†çš„ä¾èµ–è§„åˆ™

- **Dependencies** ç›´æ¥ä¾èµ–ï¼Œå½“ä»–äººå®‰è£…ä½ çš„åŒ…æ—¶ï¼Œä¼šè‡ªåŠ¨ä¸‹è½½Dependenciesä¸­çš„å†…å®¹
- **DevDependencies** å¼€å‘æ—¶ä¾èµ–ï¼Œå½“ä»–äººå®‰è£…ä½ çš„åŒ…æ—¶ï¼Œä¸ä¼šè‡ªåŠ¨ä¸‹è½½DevDependenciesä¸­çš„å†…å®¹
- **PeerDependencie** å¯¹ç­‰ä¾èµ–ï¼Œå½“ä»–äººå®‰è£…ä½ çš„åŒ…æ—¶ï¼Œå¦‚æœä»–node_modelesæ ¹ç›®å½•**ä¸­å·²ç»æœ‰èƒ½å…¼å®¹è¯¥ä½ çš„ä¾èµ–çš„ç‰ˆæœ¬**ï¼Œåˆ™ä¸ä¼šè‡ªåŠ¨ä¸‹è½½ï¼Œ**å¦åˆ™åˆ™ä¼šæŠ¥é”™æˆ–è€…ä¾èµ–å®‰è£…æ— æ•ˆã€‚** [å…·ä½“å®‰è£…æƒ…å†µå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ](https://juejin.cn/post/7170716245762048036#heading-1)



### unmonoçš„æ„å»ºç­–ç•¥


- **DevDependencies** ä¸­çš„æ‰€æœ‰ä¾èµ–ä¼šè¢«æ„å»ºåˆ°äº§ç‰©ä¸­
- **Dependencies** ä¸­æ‰€æœ‰çš„ä¾èµ–ä¸ä¼šè¢«æ„å»ºåˆ°äº§ç‰©ä¸­
- **PeerDependencie** ä¸­æ‰€æœ‰çš„ä¾èµ–ä¸ä¼šè¢«æ„å»ºåˆ°äº§ç‰©ä¸­


## ä¾èµ–æŒ‡å¼•
å¦‚æœä½ ä¸èƒ½å¤Ÿç†è§£ä¸Šè¿°ä¾èµ–å…³ç³»æˆ–è€…æ„å»ºç­–ç•¥ï¼Œé‚£ä¹ˆè¯·ä»”ç»†é˜…è¯»ä»¥ä¸‹æŒ‡å¼•

### ç»„ä»¶åº“ï¼ŒJSå·¥å…·ç±»åº“
éƒ½åº”è¯¥å®‰è£…åˆ°DevDependenciesä¸­ï¼Œæ•ˆæœä¸ºæ„å»ºæ—¶ï¼Œunmonoä¼šå°†è¿™äº›åŒ…ä¸­**ä½¿ç”¨åˆ°æ–¹æ³•æˆ–è€…ç»„ä»¶**tree-shakingåˆ°äº§ç‰©ä¸­ï¼Œå¹¶ä¸”ä»–äººåœ¨å®‰è£…ä½ çš„åŒ…çš„æ—¶å€™ä¸ä¼šå»ä¸‹è½½è¿™äº›åŒ…ï¼Œä¾‹å¦‚ï¼š

* lodash
* antd-vue
* element-ui

### eslintï¼Œprettierï¼Œ@types/*
ä¹Ÿéƒ½åº”è¯¥å®‰è£…åˆ°DevDependenciesä¸­ï¼Œæˆ‘ä»¬åªå¸Œæœ›ä»–äººåœ¨å®‰è£…ä½ çš„åŒ…çš„æ—¶å€™ä¸è¦å»ä¸‹è½½è¿™äº›åŒ…ï¼Œæ‰€ä»¥ç±»ä¼¼è¿™äº›ï¼š

* eslint
* prettier
* @types/lodash

### ä¸¥æ ¼ç‰ˆæœ¬è¦æ±‚çš„æ ¸å¿ƒåº“å’Œæ¡†æ¶ 

éƒ½åº”è¯¥å®‰è£…åˆ°Dependenciesä¸­, æ•ˆæœä¸ºæ„å»ºæ—¶ï¼Œunmonoä¸ä¼šå¯¹è¿™äº›åŒ…å†…å®¹è¿›è¡Œæ‰«ææ„å»ºï¼Œè€Œæ˜¯ä½œä¸ºå…³è”çš„å¼•ç”¨ä¾èµ–ã€‚ä»–äººå®‰è£…ä½ çš„åŒ…æ—¶ï¼ŒåŒ…ç®¡ç†ä¿è¯ä½ çš„åŒ…å¯ä»¥å¾—åˆ°å®ƒè¦æ±‚çš„ç‰ˆæœ¬

::: details åŒ…ç®¡ç†ç‰ˆæœ¬åŒ¹é…å’Œç¼“å­˜ç­–ç•¥
æ­£å¸¸æƒ…å†µä¸‹ï¼ŒåŒ…ç®¡ç†ä¼šç›´æ¥ä¸‹è½½ä½ çš„åŒ…çš„Dependenciesä¾èµ–åˆ°node_modulesæ ¹ç›®å½•ï¼Œä½†æ˜¯å®ƒæœ‰ä¸€å®šçš„ç¼“å­˜ç­–ç•¥

å‡å¦‚åŒ…ç®¡ç†ä¸ºå…¶ä»–åŒ…ä¸‹è½½è¿‡`node_modules/xxx@5.2.2`

ä½ çš„åŒ…è¦æ±‚`xxx@~5.2.0`(æ ¹æ®ä¸‹é¢çš„åŒ¹é…åŸåˆ™ï¼ŒèŒƒå›´æ˜¯`xx@5.2.0`-`xx@5.3.0`)

åŒ…ç®¡ç†ä¸‹è½½è¿‡çš„ç‰ˆæœ¬`node_modules/xxx@5.2.2`æ»¡è¶³ä½ çš„è¦æ±‚ï¼Œé‚£ä¹ˆå°±ä¸ä¼šé‡å¤ä¸‹è½½ï¼Œè¿™ç§æƒ…å†µå°±å±äºåŒ¹é…ä¸Šäº†ç‰ˆæœ¬

* `~ `æ³¢æµªå·ï¼ŒåŒ¹é…æœ€æ–°è¡¥ä¸ç‰ˆæœ¬å·ï¼Œå³ç‰ˆæœ¬å·çš„ç¬¬ä¸‰ä¸ªæ•°å­—ï¼Œä¾‹å¦‚ ~5.0.0 å°±ä¼šåŒ¹é… 5.0.x ç‰ˆæœ¬ï¼Œå°†åœ¨ 5.1.0 åœæ­¢
* `^ `æ’å…¥ç¬¦å·ï¼ŒåŒ¹é…æ¬¡è¦çš„ç‰ˆæœ¬å·ï¼Œå³ç‰ˆæœ¬å·çš„ç¬¬äºŒä¸ªæ•°å­—ï¼Œä¾‹å¦‚ ^5.2.0 å°±ä¼šåŒ¹é…ç­‰äºæˆ–å¤§äºè®¾ç½®çš„ç‰ˆæœ¬(è¿™é‡Œå°±æ˜¯ >= 5.2.0 < 6.0.0 )ï¼Œå°†åœ¨ 6.0.0 åœæ­¢
* `>ã€<ã€>=ã€<=` æ¯”è¾ƒè¿ç®—ç¬¦ï¼ŒåŒ¹é…çš„å°±æ˜¯è¿™ä¸ªåŒºé—´çš„ç‰ˆæœ¬ï¼Œä¾‹å¦‚ >2.0.0 <= 2.1.4 ï¼Œå°±ä¼šåŒ¹é…è¿™ä¸ªåŒºé—´çš„ç‰ˆæœ¬å·

:::

ä¸¾ä¾‹ï¼š
* pinia
* vuex
* vue-router

### å®½æ¾çš„ç‰ˆæœ¬è¦æ±‚çš„æ ¸å¿ƒåº“å’Œæ¡†æ¶

æ¨èå®‰è£…åˆ°PeerDependencieä¸­, æ•ˆæœä¸ºæ„å»ºæ—¶ï¼Œunmonoä¸ä¼šå¯¹è¿™äº›åŒ…å†…å®¹è¿›è¡Œæ„å»ºï¼Œè€Œæ˜¯ä½œä¸ºå…³è”çš„å¼•ç”¨ä¾èµ–ã€‚ä»–äººå®‰è£…ä½ çš„åŒ…æ—¶ï¼ŒåŒ…ç®¡ç†ä¸ä¼šå»ä¸‹è½½è¿™äº›åŒ…ï¼Œå¹¶ä¸”ä¸ä¿è¯ä½ å¾—åˆ°è¿™äº›åŒ…

ä¸¾ä¾‹ï¼š
* vue
* react


### å¦‚ä½•åœ¨å¯¹ç­‰ä¾èµ–å’Œç›´æ¥ä¾èµ–ä¹‹é—´é€‰æ‹©ï¼Ÿ

::: details è¿™ç§æƒ…å†µé€‰æ‹©å¯¹ç­‰ä¾èµ–(PeerDependencie)
å¯¹ç­‰ä¾èµ–è¦æ±‚çš„ä¾èµ–é¡¹(PeerDependencie)é€šå¸¸æ¯”è¾ƒå®½æ¾ï¼Œå¾ˆå®¹æ˜“å‘½ä¸­ç¼“å­˜ï¼Œç”¨æˆ·å®‰è£…èµ·æ¥æ›´å¿«ã€‚
å¹¶ä¸”ä½ å¯ä»¥è‚¯å®šç”¨æˆ·å·²ç»åœ¨å®ƒçš„é¡¹ç›®ä¸­ç›´æ¥å®‰è£…è¿‡é‚£ä¸ªåŒ…ï¼Œé‚£ä¹ˆè¯·é€‰æ‹©PeerDependencie

ä¾‹å¦‚å¯¹æ¡†æ¶çš„å¤§ç‰ˆæœ¬è¦æ±‚ é‚£ä¹ˆPeerDependencie.react@>=18.0.0
:::


::: details è¿™ç§æƒ…å†µé€‰æ‹©ç›´æ¥ä¾èµ–(Dependencies)
ç›´æ¥ä¾èµ–è¦æ±‚çš„ä¾èµ–é¡¹(Dependencies)é€šå¸¸æ¯”è¾ƒä¸¥æ ¼ï¼Œå½“ç„¶ä½ å¯ä»¥æ§åˆ¶ä¸¥æ ¼ç¨‹åº¦
å¦‚æœä½ ä¸èƒ½è‚¯å®šç”¨æˆ·å·²ç»å®‰è£…è¿‡é‚£ä¸ªåŒ…ï¼Œé‚£ä¹ˆè¯·é€‰æ‹©Dependencies
ä¾‹å¦‚ç”¨æˆ·æœ‰å¯èƒ½æ²¡å®‰è£…vuexï¼Œé‚£ä¹ˆDependencies.vuex@~5.2.0
:::







